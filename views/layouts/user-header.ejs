<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Glow Spot</title>
    <meta name="keywords" content="HTML5 Template">
    <meta name="description" content="Molla - Bootstrap eCommerce Template">
    <meta name="author" content="p-themes">
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/icons/favicon-16x16.png">
    <link rel="manifest" href="/assets/images/icons/site.html">
    <link rel="mask-icon" href="/assets/images/icons/safari-pinned-tab.svg" color="#666666">
    <link rel="shortcut icon" href="/assets/images/icons/favicon.ico">
    <meta name="apple-mobile-web-app-title" content="Molla">
    <meta name="application-name" content="Molla">
    <meta name="msapplication-TileColor" content="#cc9966">
    <meta name="msapplication-config" content="/assets/images/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <!-- Plugins CSS File -->
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/plugins/owl-carousel/owl.carousel.css">
    <link rel="stylesheet" href="/assets/css/plugins/magnific-popup/magnific-popup.css">
    <!-- Main CSS File -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <style>
        #dropdown-menu {
            display: none; /* Initially hide the dropdown menu */
        }
        body {
            font-family: 'Times New Roman', Times, serif;
            padding-top: 56px; /* Adjust this value if header height changes */
        }
        .dropdown:hover #dropdown-menu {
            display: flex; /* Show the dropdown menu when the welcome username is hovered */
        }
        /* Cart count styles */
        .cart-count {
            position: absolute;
            top: -15px; /* Adjust the vertical position */
            right: -15px; /* Adjust the horizontal position */
            background-color: rgb(211, 38, 38); /* Change the background color */
            color: #ffffff; /* Change the text color */
            border-radius: 50%; /* Make it round */
            padding: 5px 8px; /* Adjust padding */
            font-size: 6px; /* Adjust font size */
            -webkit-text-fill-color: #ffffff;
        }
        .icon {
            width: 30px;
            height: 30px;
        }
        .icon-heart, .icon-cart {
            fill: white;
        }
    </style>
</head>
    <body>
    <header class="header fixed-top">
    

        <div class="header-middle sticky-header">
            <div class="container">
                <div class="header-left">
                    <button class="mobile-menu-toggler">
                        <span class="sr-only"></span>
                        <i class="icon-bars"></i>
                    </button>

                    <a href="" class="logo">
                        <img src="/images/logo.jfif" alt="Molla Logo" width="105" height="25">
                    </a>

                    <nav class="main-nav">
                        <ul class="menu sf-arrows">
                            <li>
                                <a href="/" class="sf-with-ul">Home</a>
                            </li>
                            <li>
                                <a href="/category" class="sf-with-ul">Shop</a>
                            </li>
                        </ul><!-- End .menu -->
                    </nav><!-- End .main-nav -->
                </div><!-- End .header-left -->

                <div class="header-right">
                    <ul class="top-menu">
                        <li>
                            <a href="#">Links</a>
                            <ul>
                                <% if (loggedin) { %>
                                    <% if (user) { %>
                                        <li class="dropdown">
                                            <a href="#" class="dropdown-toggle"><i class="icon-user"></i>Welcome, <%= user.name %><b class="caret"></b></a>
                                            <ul class="dropdown-menu" id="dropdown-menu">
                                                <li><a href="/userprofile">Profile</a></li>
                                                <li><a href="/logout">Logout</a></li>
                                            </ul>
                                        </li>
                                    <% } else { %>
                                        <li><a href="/login"><i class="icon-user"></i>Login</a></li>
                                    <% } %>
                                <% } else { %>
                                    <li><a href="/login"><i class="icon-user"></i>Login</a></li>
                                <% } %>   
                            </ul>
                        </li>
                    </ul><!-- End .top-menu -->
                    
                    <div class="dropdown cart-dropdown">
                        <a href="/wishlist" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false" data-display="static">
                            <svg class="icon icon-heart" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6.42 3.42 5 5.5 5c1.74 0 3.41 1.01 4.5 2.09C11.09 6.01 12.76 5 14.5 5 16.58 5 18 6.42 18 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="#000000"/>
                            </svg>
                            
                            <span id="wishlist-count" class="cart-count">0</span> <!-- Wishlist count -->
                        </a>
                    </div>
                            
                    <div class="dropdown cart-dropdown">
                        <a href="/cart" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false" data-display="static">
                            <svg class="icon icon-cart" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 20c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm7 0c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zM7.82 15l1.35-6.5h8.91L21 13.38V16h-2.42c-.58 0-1.05.37-1.23.88l-1.73 5.1c-.17.5-.64.88-1.23.88H8.82c-.59 0-1.06-.37-1.23-.88l-1.74-5.1A1.32 1.32 0 0 0 4.82 16H2v-2.62L4.57 4h14.65L20.9 9H7.7L7.82 15z" fill="#000000"/>
                            </svg>
                            
                            <span id="cart-count" class="cart-count">0</span> <!-- Cart count -->
                        </a>
                    </div>
                </div><!-- End .header-right -->
            </div><!-- End .container -->
        </div><!-- End .header-middle -->
    </header><!-- End .header -->
<div class="mobile-menu-overlay"></div><!-- End .mobil-menu-overlay -->

<div class="mobile-menu-container">
    <div class="mobile-menu-wrapper">
        <span class="mobile-menu-close"><i class="icon-close"></i></span>

       <br><br><br>
        
        <nav class="mobile-nav">
            <ul class="mobile-menu">
                <li class="active">
                    <a href="/">Home</a>

                   
                </li>
                <li>
                    <a href="/category">Shop</a>
                    
                </li>
               
            </ul>
        </nav><!-- End .mobile-nav -->

       
    </div><!-- End .mobile-menu-wrapper -->
</div><!-- End .mobile-menu-container -->

<script>
    // Function to fetch initial cart count
    function fetchInitialCartCount() {
        fetch('/cart/count', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            } else {
                throw new Error('Failed to fetch cart count');
            }
        })
        .then(data => {
            updateCartCount(data.cartCount); // Update the cart count
        })
        .catch(error => {
            console.error('Error fetching cart count:', error);
            // Handle error as needed
        });
    }

    // Function to update cart count in the frontend
    function updateCartCount(count) {
        const cartCountElement = document.getElementById('cart-count');
        if (cartCountElement) {
            cartCountElement.textContent = count;
        }
    }

    // Function to add product to cart
    function addToCart(productId) {
        fetch(`/cart/add-to-cart/${productId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            } else {
                throw new Error('Failed to add product to cart');
            }
        })
        .then(data => {
            updateCartCount(data.cartCount); // Update the cart count
            // Optionally, display a success message or perform other actions
        })
        .catch(error => {
            console.error('Error adding to cart:', error);
            // Handle error as needed
        });
    }

    // Fetch initial cart count when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        fetchInitialCartCount();
    });

    // Function to fetch initial wishlist count
    function fetchInitialWishlistCount() {
        fetch('/wishlist/count', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            } else {
                throw new Error('Failed to fetch wishlist count');
            }
        })
        .then(data => {
            updateWishlistCount(data.wishlistCount); // Update the wishlist count
        })
        .catch(error => {
            console.error('Error fetching wishlist count:', error);
            // Handle error as needed
        });
    }

    // Function to update wishlist count in the frontend
    function updateWishlistCount(count) {
        const wishlistCountElement = document.getElementById('wishlist-count');
        if (wishlistCountElement) {
            wishlistCountElement.textContent = count;
        }
    }

    // Function to add product to wishlist
    function addToWishlist(productId) {
        fetch(`/wishlist/add-to-wishlist/${productId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            } else {
                throw new Error('Failed to add product to wishlist');
            }
        })
        .then(data => {
            updateWishlistCount(data.wishlistCount); // Update the wishlist count
            // Optionally, display a success message or perform other actions
        })
        .catch(error => {
            console.error('Error adding to wishlist:', error);
            // Handle error as needed
        });
    }

    // Fetch initial wishlist count when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        fetchInitialWishlistCount();
    });
</script>

</body>
</html>
